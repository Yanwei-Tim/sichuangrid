<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="actualCompany">
	<typeAlias alias="ActualCompany" type="com.tianque.baseInfo.actualCompany.domain.ActualCompany"/>
	<typeAlias alias="people" type="com.tianque.baseInfo.base.domain.People"/>
	<typeAlias alias="layoutTag" type="com.tianque.baseInfo.buildDatas.domain.vo.LayoutTagVo" />
	<typeAlias alias="actualCompanyPractitioners" type="com.tianque.baseInfo.actualCompany.domain.ActualCompanyPractitioners" />
	<resultMap class="ActualCompany" id="actualCompanyResult" extends="locationBaseInfo.locationBaseInfoResult">
		<result property="organization.id" column="orgId"/>
		<result property="orgInternalCode" column="orgInternalCode"/>
		<result property="companyName" column="companyName"/>
		<result property="addressId" column="addressId"/>
		<result property="companyAddress" column="companyAddress"/>
		<result property="companyType.id" column="companyType"/>
		<result property="isKey" column="isKey"/>
		<result property="corporateRepresentative" column="corporateRepresentative"/>
		<result property="idCardNo" column="idCardNo"/>
		<result property="telephone" column="telephone"/>
		<result property="facsimile" column="facsimile"/>
		<result property="businessLicenseNo" column="businessLicenseNo"/>
		<result property="orgCode" column="orgCode"/>
		<result property="registeredCapital" column="registeredCapital"/>
		<result property="economicNature.id" column="economicNature"/>
		<result property="expiryDate" column="expiryDate"/>
		<result property="registrationDate" column="registrationDate"/>
		<result property="businessScope" column="businessScope"/>
		<result property="registrationAddress" column="registrationAddress"/>
		<result property="employeesNum" column="employeesNum"/>
		<result property="competentDepartment" column="competentDepartment"/>
		<result property="supervisoryLevel.id" column="supervisoryLevel"/>
		<result property="supervisoryDepartment" column="supervisoryDepartment"/>
		<result property="fireFightingLevel.id" column="fireFightingLevel"/>
		<result property="securityChief" column="securityChief"/>
		<result property="remark" column="remark"/>
		<result property="imgUrl" column="imgUrl"/>
		<result property="fullPinyin" column="fullPinyin"/>
		<result property="simplePinyin" column="simplePinyin"/>
		<result property="isEmphasis" column="isEmphasis"/>
		<result property="createUser" column="createUser"/>
		<result property="createDate" column="createDate"/>
		<result property="updateUser" column="updateUser"/>
		<result property="updateDate" column="updateDate"/>	
		<result property="logOutTime" column="logOutTime"/>	
		<result property="logOutReason" column="logOutReason"/>		
		
		<result property="keyName" column="keyName"/>
		<result property="policeNumber" column="policeNumber"/>
		<result property="position" column="position"/>
		<result property="importantFacilities" column="importantFacilities"/>
		<result property="convoyNumber" column="convoyNumber"/>
		<result property="economicValue" column="economicValue"/>
		<result property="securityNumber" column="securityNumber"/>
		<result property="staffNumber" column="staffNumber"/>
		<result property="classicsAlarmNumber" column="classicsAlarmNumber"/>
		<result property="keyPhone" column="keyPhone"/>
		<result property="location" column="location"/>
		<result property="defendEstablishment" column="defendEstablishment"/>
		<result property="chief" column="chief"/>
		<result property="chiefIdNumber" column="chiefIdNumber"/>
		<result property="relevantSafety" column="relevantSafety"/>
		<result property="safetyMeasures" column="safetyMeasures"/>
		<result property="civilMeasures" column="civilMeasures"/>
		<result property="thingMeasures" column="thingMeasures"/>
		<result property="dogMeasures" column="dogMeasures"/>
		<result property="judgementBasis" column="judgementBasis"/>
		<result property="safetyMeasuresFunds" column="safetyMeasuresFunds"/>
		
		
		<result property="facilitiesName" column="facilitiesName"/>
		<result property="facilitiesCategory.id" column="facilitiesCategory"/>
		<result property="installationTime" column="installationTime"/>
		<result property="investmentAmount" column="investmentAmount"/>
		<result property="installationPosition" column="installationPosition"/>
		<result property="securityClassification.id" column="securityClassification"/>
		<result property="canLose" column="canLose"/>
		<result property="connectedDepartment" column="connectedDepartment"/>
		<result property="coverageArea" column="coverageArea"/>
		<result property="keepDays" column="keepDays"/>
		<result property="storageWays" column="storageWays"/>
		<result property="camerasNumber" column="camerasNumber"/>
		<result property="configurationDescribe" column="configurationDescribe"/>
		<result property="intrusionDetectorNumber" column="intrusionDetectorNumber"/>
		
		  <result property="gisInfo.buildingId" column="builddatasId" />
        <result property="gisInfo.centerX" column="centerX" />
        <result property="gisInfo.centerY" column="centerY" />
        <result property="sourcesState" column="sourcesState"/>
	</resultMap>
	
	<resultMap class="ActualCompany" id="actualCompanyResultForList" extends="locationBaseInfo.locationBaseInfoResultForList">
		<result property="organization.id" column="orgId"/>
		<result property="orgInternalCode" column="orgInternalCode"/>
		<result property="companyName" column="companyName"/>
		<result property="addressId" column="addressId"/>
		<result property="companyAddress" column="companyAddress"/>
		<result property="companyType.id" column="companyType"/>
		<result property="isKey" column="isKey"/>
		<result property="corporateRepresentative" column="corporateRepresentative"/>
		<result property="idCardNo" column="idCardNo"/>
		<result property="telephone" column="telephone"/>
		<result property="facsimile" column="facsimile"/>
		<result property="businessLicenseNo" column="businessLicenseNo"/>
		<result property="orgCode" column="orgCode"/>
		<result property="registeredCapital" column="registeredCapital"/>
		<result property="economicNature.id" column="economicNature"/>
		<result property="expiryDate" column="expiryDate"/>
		<result property="registrationDate" column="registrationDate"/>
		<result property="businessScope" column="businessScope"/>
		<result property="registrationAddress" column="registrationAddress"/>
		<result property="employeesNum" column="employeesNum"/>
		<result property="competentDepartment" column="competentDepartment"/>
		<result property="supervisoryLevel.id" column="supervisoryLevel"/>
		<result property="supervisoryDepartment" column="supervisoryDepartment"/>
		<result property="fireFightingLevel.id" column="fireFightingLevel"/>
		<result property="securityChief" column="securityChief"/>
		<result property="remark" column="remark"/>
		<result property="imgUrl" column="imgUrl"/>
		<result property="fullPinyin" column="fullPinyin"/>
		<result property="simplePinyin" column="simplePinyin"/>
		<result property="isEmphasis" column="isEmphasis"/>
		<result property="createUser" column="createUser"/>
		<result property="createDate" column="createDate"/>
		<result property="updateUser" column="updateUser"/>
		<result property="updateDate" column="updateDate"/>	
		<result property="logOutTime" column="logOutTime"/>	
		<result property="logOutReason" column="logOutReason"/>		
		
		<result property="keyName" column="keyName"/>
		<result property="policeNumber" column="policeNumber"/>
		<result property="position" column="position"/>
		<result property="importantFacilities" column="importantFacilities"/>
		<result property="convoyNumber" column="convoyNumber"/>
		<result property="economicValue" column="economicValue"/>
		<result property="securityNumber" column="securityNumber"/>
		<result property="staffNumber" column="staffNumber"/>
		<result property="classicsAlarmNumber" column="classicsAlarmNumber"/>
		<result property="keyPhone" column="keyPhone"/>
		<result property="location" column="location"/>
		<result property="defendEstablishment" column="defendEstablishment"/>
		<result property="chief" column="chief"/>
		<result property="chiefIdNumber" column="chiefIdNumber"/>
		<result property="relevantSafety" column="relevantSafety"/>
		<result property="safetyMeasures" column="safetyMeasures"/>
		<result property="civilMeasures" column="civilMeasures"/>
		<result property="thingMeasures" column="thingMeasures"/>
		<result property="dogMeasures" column="dogMeasures"/>
		<result property="judgementBasis" column="judgementBasis"/>
		<result property="safetyMeasuresFunds" column="safetyMeasuresFunds"/>
		
		
		<result property="facilitiesName" column="facilitiesName"/>
		<result property="facilitiesCategory.id" column="facilitiesCategory"/>
		<result property="installationTime" column="installationTime"/>
		<result property="investmentAmount" column="investmentAmount"/>
		<result property="installationPosition" column="installationPosition"/>
		<result property="securityClassification.id" column="securityClassification"/>
		<result property="canLose" column="canLose"/>
		<result property="connectedDepartment" column="connectedDepartment"/>
		<result property="coverageArea" column="coverageArea"/>
		<result property="keepDays" column="keepDays"/>
		<result property="storageWays" column="storageWays"/>
		<result property="camerasNumber" column="camerasNumber"/>
		<result property="configurationDescribe" column="configurationDescribe"/>
		<result property="intrusionDetectorNumber" column="intrusionDetectorNumber"/>
		
		  <result property="gisInfo.buildingId" column="builddatasId" />
        <result property="gisInfo.centerX" column="centerX" />
        <result property="gisInfo.centerY" column="centerY" />
        <result property="sourcesState" column="sourcesState"/>
	</resultMap>
	<resultMap class="ActualCompany" id="GisCountActualCompanyInfoResult">
		<result property="gisSearchType" column="gisSearchType"/>
		<result property="giscountNum" column="giscountNum"/>
	</resultMap>
	<resultMap class="ActualCompany" id="gisSearchActualCompanyInfo">
		<result property="id" column="id"/>
		<result property="companyName" column="companyName"/>
		<result property="companyAddress" column="companyAddress"/>
		<result property="businessLicenseNo" column="businessLicenseNo"/>
		<result property="imgUrl" column="imgUrl"/>
		<result property="isEmphasis" column="isEmphasis"/>
		<result property="keyPersonType" column="keyPersonType"/>
		<result property="organization.id" column="orgId"/>
		<result property="companyType.id" column="companyType"/>
		<result property="economicNature.id" column="economicNature"/>
		<result property="corporateRepresentative" column="corporateRepresentative"/>
		<result property="gisInfo.centerX" column="centerX"/>
		<result property="gisInfo.centerY" column="centerY"/>
		<result property="gisInfo.buildingId" column="builddatasId"/>
	</resultMap>
	
	
	<insert id="addActualCompany" parameterClass="ActualCompany">
		<selectKey keyProperty="id" resultClass="java.lang.Long">
		<![CDATA[SELECT s_actualCompany.NEXTVAL AS ID FROM DUAL]]>
		</selectKey>
		insert into actualCompany(id,orgId,orgInternalCode,companyName,addressId,companyAddress,companyType,isKey,corporateRepresentative,idCardNo,telephone,facsimile,businessLicenseNo,orgCode,registeredCapital,economicNature,expiryDate,registrationDate,businessScope,registrationAddress,employeesNum,competentDepartment,supervisoryLevel,supervisoryDepartment,fireFightingLevel,securityChief,remark,imgUrl,fullPinyin,simplePinyin,isEmphasis,createUser,createDate,updateUser,updateDate,keyName,
         policeNumber,position,importantFacilities,convoyNumber,economicValue,securityNumber,staffNumber,classicsAlarmNumber,keyPhone,location,defendEstablishment,chief,chiefIdNumber,relevantSafety,safetyMeasures,civilMeasures,thingMeasures,dogMeasures,judgementBasis,safetyMeasuresFunds,facilitiesName,facilitiesCategory,installationTime,investmentAmount,installationPosition,securityClassification,canLose,connectedDepartment,coverageArea,keepDays,storageWays,camerasNumber,configurationDescribe,intrusionDetectorNumber,builddatasId,centerX,centerY,sourcesState)
		values(#id#,#organization.id#,#orgInternalCode#,#companyName#,#addressId#,#companyAddress#,#companyType.id#,#isKey#,#corporateRepresentative#,#idCardNo#,#telephone#,#facsimile#,#businessLicenseNo#,#orgCode#,#registeredCapital#,#economicNature.id#,#expiryDate#,#registrationDate#,#businessScope#,#registrationAddress#,#employeesNum#,#competentDepartment#,#supervisoryLevel.id#,#supervisoryDepartment#,#fireFightingLevel.id#,#securityChief#,#remark#,#imgUrl#,#fullPinyin#,#simplePinyin#,#isEmphasis#,#createUser#,#createDate#,#updateUser#,#updateDate#,
		#keyName#,#policeNumber#,#position#,#importantFacilities#,#convoyNumber#,#economicValue#,#securityNumber#,#staffNumber#,#classicsAlarmNumber#,#keyPhone#,#location#,#defendEstablishment#,#chief#,#chiefIdNumber#,#relevantSafety#,#safetyMeasures#,#civilMeasures#,#thingMeasures#,#dogMeasures#,#judgementBasis#,#safetyMeasuresFunds#,#facilitiesName#,#facilitiesCategory.id#,#installationTime#,#investmentAmount#,#installationPosition#,#securityClassification.id#,#canLose#,#connectedDepartment#,#coverageArea#,#keepDays#,#storageWays#,#camerasNumber#,#configurationDescribe#,#intrusionDetectorNumber#
		,#gisInfo.buildingId#,#gisInfo.centerX#,#gisInfo.centerY#,#sourcesState#) 
	</insert>
	
	
	
	<select id="getActualCompanyById" parameterClass="java.lang.Long" resultMap="actualCompanyResult">
	<![CDATA[select * from actualCompany where id=#value#]]>
	</select>
	
	<delete id="deleteActualCompany" parameterClass="java.lang.Long">
		delete from actualCompany where id=#value#
	</delete>
	
	<update id="updateActualCompany" parameterClass="ActualCompany">
		update actualCompany set
			orgId=#organization.id#,
			orgInternalCode=#orgInternalCode#,
			companyName=#companyName#,
			companyAddress=#companyAddress#,
			companyType=#companyType.id#,
			isKey=#isKey#,
			corporateRepresentative=#corporateRepresentative#,
			idCardNo=#idCardNo#,
			telephone=#telephone#,
			facsimile=#facsimile#,
			businessLicenseNo=#businessLicenseNo#,
			orgCode=#orgCode#,
			registeredCapital=#registeredCapital#,
			economicNature=#economicNature.id#,
			expiryDate=#expiryDate#,
			registrationDate=#registrationDate#,
			businessScope=#businessScope#,
			registrationAddress=#registrationAddress#,
			employeesNum=#employeesNum#,
			competentDepartment=#competentDepartment#,
			supervisoryLevel=#supervisoryLevel.id#,
			supervisoryDepartment=#supervisoryDepartment#,
			fireFightingLevel=#fireFightingLevel.id#,
			securityChief=#securityChief#,
			remark=#remark#,
			imgUrl=#imgUrl#,
			fullPinyin=#fullPinyin#,
			simplePinyin=#simplePinyin#,
			isEmphasis=#isEmphasis#,
			updateUser=#updateUser#,
			updateDate=#updateDate#,
			logOutTime=#logOutTime#,
			logOutReason=#logOutReason#,
			builddatasId=#gisInfo.buildingId#,
			centerX=#gisInfo.centerX#,
			centerY=#gisInfo.centerY#
		where id=#id#
	</update>
	
	
	<update id="updateKeyCrucialPosition"  parameterClass="ActualCompany">
			update actualCompany set
				keyName=#keyName#,
				policeNumber=#policeNumber#,
				position=#position#,
				importantFacilities=#importantFacilities#,
				convoyNumber=#convoyNumber#,
				economicValue=#economicValue#,
				securityNumber=#securityNumber#,
				staffNumber=#staffNumber#,
				classicsAlarmNumber=#classicsAlarmNumber#,
				keyPhone=#keyPhone#,
				location=#location#,
				defendEstablishment=#defendEstablishment#,
				chief=#chief#,
				chiefIdNumber=#chiefIdNumber#,
				relevantSafety=#relevantSafety#,
				safetyMeasures=#safetyMeasures#,
				civilMeasures=#civilMeasures#,
				thingMeasures=#thingMeasures#,
				dogMeasures=#dogMeasures#,
				judgementBasis=#judgementBasis#,
				safetyMeasuresFunds=#safetyMeasuresFunds#
	        where id=#id#
	</update>
	
	<update id="updatePreventionFacilities"  parameterClass="ActualCompany">
		update actualCompany set
			facilitiesName=#facilitiesName#,
			facilitiesCategory=#facilitiesCategory.id#,
			installationTime=#installationTime#,
			investmentAmount=#investmentAmount#,
			installationPosition=#installationPosition#,
			securityClassification=#securityClassification.id#,
			canLose=#canLose#,
			connectedDepartment=#connectedDepartment#,
			coverageArea=#coverageArea#,
			keepDays=#keepDays#,
			storageWays=#storageWays#,
			camerasNumber=#camerasNumber#,
			configurationDescribe=#configurationDescribe#,
			intrusionDetectorNumber=#intrusionDetectorNumber#
          where id=#id#
	</update>
	
	
	<select id="searchAllRoundCompany" parameterClass="java.util.Map" resultMap="actualCompanyResult">
		<![CDATA[
		 select *  from actualCompany t where t.centerx > #minOption.centerX#   and   t.centerx < #maxOption.centerX# 
         and  t.centery > #minOption.centerY#  and   t.centery < #maxOption.centerY#
        ]]>
	</select>
	
	<select id="findActualCompany" parameterClass="java.util.Map" resultMap="actualCompanyResultForList">
		select actualCompany.*,'$objectType$' as locationType  from actualCompany where orgInternalCode like #orgInternalCode#||'%'
		<dynamic>
			<isPropertyAvailable property="isEmphasis">
				<isNotNull property="isEmphasis" prepend="and">
						isEmphasis = #isEmphasis#
				</isNotNull>
			</isPropertyAvailable>
			<isPropertyAvailable property="sortField" prepend="order by">
				<isNotNull property="sortField">$sortField$</isNotNull>
				<isNotNull property="order">$order$</isNotNull>
			</isPropertyAvailable>
		</dynamic>
	</select>
	
	<select id="countActualCompany" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		select count(*) from ActualCompany where orgInternalCode like #orgInternalCode#||'%'
		<dynamic>
			<isPropertyAvailable property="isEmphasis">
				<isNotNull property="isEmphasis" prepend=" and ">
						isEmphasis = #isEmphasis#
				</isNotNull>
			</isPropertyAvailable>
		</dynamic>
	</select>
	
	<select id="getActualCompanyByCompanyName" parameterClass="java.util.Map" resultMap="actualCompanyResult">
	<![CDATA[ select * FROM actualCompany where companyName = #companyName# and orgId=#orgId#]]>
	</select>	
	
	<select id="countSearchActualCompany" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		select count(*) from ActualCompany where orgInternalCode like #orgInternalCode#||'%'
	</select>
	
	<select id="countActualCompanyByOrgId" parameterClass="String" resultMap="GisCountActualCompanyInfoResult">
		select count(*) as giscountNum , 'actualUnit' as gisSearchType 
			from ActualCompany where orgInternalCode like #orgInternalCode#||'%'
	</select>
	
	
	
	<select id="countActualUnitforGisByorgIdAndQueryStr" parameterClass="java.util.Map"  resultClass="java.lang.Integer">
		select count(*) from ActualCompany where orgInternalCode like '$orgInternalCode$%' and
		(companyName like '$queryStr$%' or companyAddress like '%$queryStr$%' or simplepinyin like '$queryStr$%' or fullpinyin like '$queryStr$%' or businesslicenseno like '$queryStr$%')
		
	</select>
	
	<select id="searchActualUnitforGisByorgIdAndQueryStr" parameterClass="map" resultMap="gisSearchActualCompanyInfo">
		select 'searchActualUnit' as keyPersonType, ay.* from ActualCompany  ay where ay.orgInternalCode like '$orgInternalCode$%' and
		(ay.companyName like '$queryStr$%' or ay.companyAddress like '%$queryStr$%' or ay.simplepinyin like '$queryStr$%' or ay.fullpinyin like '$queryStr$%' or ay.businesslicenseno like '$queryStr$%')
		<dynamic prepend="order by">
			<isPropertyAvailable property="sortField">
				<isNotEmpty property="sortField">$sortField$</isNotEmpty>
				<isNotEmpty property="order">$order$</isNotEmpty>
			</isPropertyAvailable>
		</dynamic>
	</select>
	
	<select id="getActualUnitDatialInfoByUnitId" parameterClass="java.lang.Long" resultMap="gisSearchActualCompanyInfo">
		select 'searchActualUnit' as keyPersonType, ay.* from  ActualCompany  ay where ay.id =#id#
	</select>
	
	<select id="countKeyUnitListSearchByOrgInternalCode" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		select count(*) from ActualCompany where orgInternalCode like '$orgInternalCode$%'
	</select>
	
	<select id="searchKeyUnitListSearchByOrgInternalCode" parameterClass="map" resultMap="gisSearchActualCompanyInfo">
		select 'searchActualUnit' as keyPersonType, ay.* from  ActualCompany  ay where ay.orgInternalCode like '$orgInternalCode$%'
		<dynamic prepend=" order by">
			<isPropertyAvailable property="sortField">
				<isNotEmpty property="sortField">$sortField$</isNotEmpty>
				<isNotEmpty property="order">$order$</isNotEmpty>
			</isPropertyAvailable>
		</dynamic>
	</select>
	
	<select id="findAllBindingActualUnitByOrgInternalCodeForGis" parameterClass="String" resultMap="gisSearchActualCompanyInfo">
		select 'actualUnit' as keyPersonType, ay.* from actualCompany ay 
		 where ay.orgInternalCode like #orgInternalCode#||'%'
		   and ay.builddatasId is not null
	</select>
	
	<select id="countBindingActualUnitBybuildingIdForGis" parameterClass="long" resultClass="java.lang.Integer">
		select count(*) from actualCompany ay 
		 where ay.builddatasId = #buildingId#
	</select>
	
	<update id="updateactualCompanyInfoForGis" parameterClass="ActualCompany">
		update  actualCompany set
			 centerX=#gisInfo.centerX#,
			 centerY=#gisInfo.centerY#,
			 builddatasId=#gisInfo.buildingId#,
			 updateDate=#updateDate#,
			 updateUser=#updateUser# 
		where id =#id#
	</update>
	<update id="unBindActualCompanyOnMap" parameterClass="java.lang.Long">
		 <![CDATA[ 	
			update  actualCompany set
				 centerX=null,
				 centerY=null,
				 builddatasId=null
			where id =#id#
			 ]]>
	</update>
	
	<select id="countActualCompanyByBuilddatasId" resultClass="Integer" parameterClass="map">
		select count(*) from actualCompany where builddatasid = #builddatasId#
	</select>
	
	<select id="findActualCompanyByBuilddatasIdForPage" resultMap="actualCompanyResult" parameterClass="map">
		<include refid="common.sql_select" />
		from actualCompany
		where builddatasid = #builddatasId#
		<dynamic prepend="order by">
			<isPropertyAvailable property="sortField">
				<isNotNull property="sortField">$sortField$</isNotNull>
				<isNotNull property="order">$order$</isNotNull>
			</isPropertyAvailable>
		</dynamic>
	</select>
	
	<select id="countUnboundActualCompanyByOrg" resultClass="Integer" parameterClass="map">
		select count(*) from actualCompany 
		where orgInternalCode like #orgInternalCode#||'%'
		 and builddatasid is null
		 <isPropertyAvailable property="queryStr">
		 	<isNotNull property="queryStr" prepend="and" open="(" close=")">
		 		corporateRepresentative like #queryStr#||'%' or companyName like #queryStr#||'%'
		 	</isNotNull>
		 </isPropertyAvailable>
	</select>
	
	<select id="findUnboundActualCompanyByOrgForPage" resultMap="actualCompanyResult" parameterClass="map" >
		select * from actualCompany
		where orgInternalCode like #orgInternalCode#||'%'
		and builddatasid is null
		<isPropertyAvailable property="queryStr">
		 	<isNotNull property="queryStr" prepend="and" open="(" close=")">
		 		corporateRepresentative like #queryStr#||'%' or companyName like #queryStr#||'%'
		 	</isNotNull>
		 </isPropertyAvailable> 
		 <dynamic prepend="order by">
			<isPropertyAvailable property="sortField">
				<isNotNull property="sortField">$sortField$</isNotNull>
				<isNotNull property="order">$order$</isNotNull>
			</isPropertyAvailable>
		</dynamic>
	</select>
	
	<update id="boundActualCompany" parameterClass="map">
		update actualCompany set builddatasid=#buildDatasId#
		where id in(
			<iterate property="ids" conjunction="," >
				#ids[]# 
			</iterate>
		)
	</update>
	
	<update id="unboundActualCompany" parameterClass="map">
		update actualCompany set builddatasid=null
		where id in(
			<iterate property="ids" conjunction="," >
				#ids[]# 
			</iterate>
		)
	</update>
	
	<select id="searchAllActualCompanyName" resultClass="layoutTag" parameterClass="map">
		select id as id, companyName as label, '单位' as category, 2 as buildType from actualcompany where orginternalcode like #orgInternalCode#||'%' and builddatasid=#buildDatasId#
	</select>
	<select id="getActualCompanyNameById" resultClass="String" parameterClass="map">
		select companyName from actualcompany where id=#id#
	</select>
	
	<resultMap class="people" id="peopleMap">
		<result property="id" column="id"/>
		<result property="remark" column="remark"/>
		<result property="name" column="name"/>
		<result property="idCardNo" column="idCardNo"/>
		<result property="attentionPopulationType" column="attentionPopulationType"/>
		<result property="gender.id" column="gender"/>
		<result property="orgInternalCode" column="orgInternalCode"/>
	</resultMap>
	<sql id="sql_ActualCompanysPractitioners">
		SELECT * FROM ACTUALCOMPANYPRACTITIONERS A,(
		SELECT ID,'H'||ID REMARK,NAME,GENDER,IDCARDNO,'户籍人口' ATTENTIONPOPULATIONTYPE,ORGINTERNALCODE FROM HOUSEHOLDSTAFFS
		UNION
		SELECT ID,'L'||ID REMARK,NAME,GENDER,IDCARDNO,'流动人口' ATTENTIONPOPULATIONTYPE,ORGINTERNALCODE FROM FLOATINGPOPULATIONS
		UNION
		SELECT ID,'W'||ID REMARK,NAME,GENDER,IDCARDNO,'未落户人口' ATTENTIONPOPULATIONTYPE,ORGINTERNALCODE FROM UNSETTLEDPOPULATIONS
		) B WHERE A.PERSONID = B.ID AND A.PERSONTYPE = B.ATTENTIONPOPULATIONTYPE AND A.ACTUALCOMPANYID = #id#
		<isNotEmpty prepend=" AND " property="name">
			B.NAME LIKE #name#||'%'
		</isNotEmpty>
	</sql>
	<select id="countActualCompanysPractitioners" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(*) FROM (<include refid="sql_ActualCompanysPractitioners"/>)
	</select>
	<select id="findActualCompanysPractitioners" parameterClass="java.util.Map" resultMap="peopleMap">
		<include refid="sql_ActualCompanysPractitioners"/>
		<dynamic prepend="order by">
			<isPropertyAvailable property="sortField">
				<isNotNull property="sortField">$sortField$</isNotNull>
				<isNotNull property="order">$order$</isNotNull>
			</isPropertyAvailable>
		</dynamic>
	</select>
	<sql id="sql_ActualCompanysAddPractitioners">
		SELECT * FROM (
			SELECT ID,'H'||ID REMARK,NAME,GENDER,IDCARDNO,'户籍人口' ATTENTIONPOPULATIONTYPE,ORGINTERNALCODE FROM HOUSEHOLDSTAFFS
			UNION
			SELECT ID,'L'||ID REMARK,NAME,GENDER,IDCARDNO,'流动人口' ATTENTIONPOPULATIONTYPE,ORGINTERNALCODE FROM FLOATINGPOPULATIONS
			UNION
			SELECT ID,'W'||ID REMARK,NAME,GENDER,IDCARDNO,'未落户人口' ATTENTIONPOPULATIONTYPE,ORGINTERNALCODE FROM UNSETTLEDPOPULATIONS
		) B WHERE NOT EXISTS (SELECT 1 FROM ACTUALCOMPANYPRACTITIONERS A WHERE A.PERSONID = B.ID AND A.PERSONTYPE = B.ATTENTIONPOPULATIONTYPE AND A.ACTUALCOMPANYID != #id#)
		<isNotEmpty prepend=" AND " property="name">
			B.NAME LIKE #name#||'%'
		</isNotEmpty>
		<isNotEmpty prepend=" AND " property="orgInternalCode">
			B.ORGINTERNALCODE LIKE #orgInternalCode#||'%'
		</isNotEmpty>
	</sql>
	<select id="countActualCompanysAddPractitioners" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		SELECT COUNT(*) FROM (<include refid="sql_ActualCompanysAddPractitioners"/>)
	</select>
	<select id="findActualCompanysAddPractitioners" parameterClass="java.util.Map" resultMap="peopleMap">
		<include refid="sql_ActualCompanysAddPractitioners"/>
		<dynamic prepend="order by">
			<isPropertyAvailable property="sortField">
				<isNotNull property="sortField">$sortField$</isNotNull>
				<isNotNull property="order">$order$</isNotNull>
			</isPropertyAvailable>
		</dynamic>
	</select>
	<delete id="deleteActualCompanyPractitioners" parameterClass="java.lang.Long">
		DELETE FROM ACTUALCOMPANYPRACTITIONERS WHERE ACTUALCOMPANYID = #id#
	</delete>
	<insert id="saveActualCompanyPractitioners" parameterClass="actualCompanyPractitioners">
		INSERT INTO ACTUALCOMPANYPRACTITIONERS(ACTUALCOMPANYID, PERSONID, PERSONTYPE) VALUES(
		#actualCompanyId#, #personId#, #personType#)
	</insert>
	<select id="queryActualCompanysAddPractitionersById" parameterClass="java.lang.Long" resultClass="actualCompanyPractitioners">
		SELECT * FROM ACTUALCOMPANYPRACTITIONERS WHERE ACTUALCOMPANYID = #id#
	</select>
	<delete id="delPersonForPractitionerst" parameterClass="actualCompanyPractitioners">
		DELETE FROM ACTUALCOMPANYPRACTITIONERS WHERE ACTUALCOMPANYID = #actualCompanyId# AND PERSONID = #personId#
	</delete>
</sqlMap>