function proccessResourcePoolPremissionTreeOption(a,b){var c={shouldJugeMultizones:!1,rootId:!1,allOrg:!1,excludeRoot:!1,orgType:!1,url:"/interation/resourcePool/firstLoadExtTreeData.action",isLocalData:!1,isRootSelected:!0,loadCom:function(){}};$.extend(c,a);var d=PATH+c.url;c.orgType&&(d=-1==d.indexOf("?")?d+"?orgType="+c.orgType:d+"&orgType="+c.orgType),0!=c.rootId&&(d=-1==d.indexOf("?")?d+"?rootId="+c.rootId:d+"&rootId="+c.rootId),c.excludeRoot&&(d=-1==d.indexOf("?")?d+"?excludeRoot="+c.excludeRoot:d+"&excludeRoot="+c.excludeRoot),c.allOrg&&(d=-1==d.indexOf("?")?d+"?allOrg="+c.allOrg:d+"&allOrg="+c.allOrg),c.shouldJugeMultizones&&(d+=-1==d.indexOf("?")?"?shouldJugeMultizones=true":"&shouldJugeMultizones=true");var e=c.viewObjtypeId;null!=e&&"undefined"!=typeof e&&(d=-1==d.indexOf("?")?d+"?viewObjtypeId="+e:d+"&viewObjtypeId="+e);var f=c.resourcePoolId;null!=f&&"undefined"!=typeof f&&(d=-1==d.indexOf("?")?d+"?resourcePoolId="+f:d+"&resourcePoolId="+f);var g=b.attr("id"),h=Ext.tree,i={animate:!1,enableDD:!1,containerScroll:!0,dropConfig:{appendOnly:!0},rootVisible:!1};c.isLocalData||(i.loader=new h.TreeLoader({dataUrl:d}));var j=new h.TreePanel(g,i);j.on("beforeload",function(a){if(a.id!=g+"-root"){var b="?parentId="+a.id;c.orgType&&(b=b+"&orgType="+c.orgType),null!=f&&"undefined"!=typeof f&&(b=b+"&resourcePoolId="+f),j.loader.dataUrl=PATH+"/interation/resourcePool/ajaxOrgsForExtTree.action"+b}a.attributes.isLoaded=!0});var k=new h.AsyncTreeNode({text:"orgManage",draggable:!1,id:g+"-root"});return j.setRootNode(k),j.render(),c.isLocalData||k.expand(!1,!1,function(a){if(null!=k.childNodes&&void 0!=k.childNodes)for(var b=0;b<k.childNodes.length;b++)k.childNodes[b].expand()}),k.expand(!1,!1,function(){j.exFunc(),c.loadCom()}),j.exFunc=function(){},j}function processResourcePoolTreeOption(a,b){var c={shouldJugeMultizones:!1,rootId:!1,allOrg:!1,excludeRoot:!1,url:"/interation/resourcePool/firstLoadDailydirectory.action",isLocalData:!1,isRootSelected:!0,isLoadDailyLogs:!1,afterNodeExpanded:!1};$.extend(c,a);var d=PATH+c.url;0!=c.rootId&&(d=-1==d.indexOf("?")?d+"?rootId="+c.rootId:d+"&rootId="+c.rootId),c.excludeRoot&&(d=-1==d.indexOf("?")?d+"?excludeRoot="+c.excludeRoot:d+"&excludeRoot="+c.excludeRoot),c.allOrg&&(d=-1==d.indexOf("?")?d+"?allOrg="+c.allOrg:d+"&allOrg="+c.allOrg),c.shouldJugeMultizones&&(d+=-1==d.indexOf("?")?"?shouldJugeMultizones=true":"&shouldJugeMultizones=true");var e=b.attr("id"),f=Ext.tree,g={animate:!0,enableDD:!1,containerScroll:!0,dropConfig:{appendOnly:!0},rootVisible:!1};c.isLocalData||(g.loader=new f.TreeLoader({dataUrl:d}));var h=new f.TreePanel(e,g);h.on("beforeload",function(a){a.id!=e+"-root"}),c.afterNodeExpanded&&h.on("load",c.afterNodeExpanded);var i=new f.TreeNode({text:"orgManage",draggable:!1,id:e+"resourcePoolDirectory-root"}),j=new f.AsyncTreeNode({text:"资料库目录树",draggable:!1,id:e+"-root",leaf:!1});return i.appendChild(j),h.setRootNode(i),h.render(),c.isLocalData||j.expand(!1,!1,function(a){h.getSelectionModel().select(j),h.fireEvent("click",j)}),h}function processPermissionTreeOption(a,b){var c={shouldJugeMultizones:!1,rootId:!1,allOrg:!1,excludeRoot:!1,orgType:!1,url:"/sysadmin/permissionManage/firstLoadPermission.action",isLocalData:!1,isRootSelected:!0};$.extend(c,a);var d=PATH+c.url;c.orgType&&(d=-1==d.indexOf("?")?d+"?orgType="+c.orgType:d+"&orgType="+c.orgType),0!=c.rootId&&(d=-1==d.indexOf("?")?d+"?rootId="+c.rootId:d+"&rootId="+c.rootId),c.excludeRoot&&(d=-1==d.indexOf("?")?d+"?excludeRoot="+c.excludeRoot:d+"&excludeRoot="+c.excludeRoot),c.allOrg&&(d=-1==d.indexOf("?")?d+"?allOrg="+c.allOrg:d+"&allOrg="+c.allOrg),c.shouldJugeMultizones&&(d+=-1==d.indexOf("?")?"?shouldJugeMultizones=true":"&shouldJugeMultizones=true");var e=b.attr("id"),f=Ext.tree,g={animate:!0,enableDD:!1,containerScroll:!0,dropConfig:{appendOnly:!0},rootVisible:!1};c.isLocalData||(g.loader=new f.TreeLoader({dataUrl:d}));var h=new f.TreePanel(e,g);h.on("beforeload",function(a){if(a.id!=e+"-root"){var b="?parentId="+a.id;c.orgType&&(b=b+"&orgType="+c.orgType),h.loader.dataUrl=PATH+"/sysadmin/permissionManage/firstLoadPermission.action"+b}});var i=new f.TreeNode({text:"orgManage",draggable:!1,id:e+"-root"}),j=new f.AsyncTreeNode({text:"权限树",draggable:!1,id:e+"-root"});return i.appendChild(j),h.setRootNode(i),h.render(),c.isLocalData||j.expand(!1,!1,function(a){j.firstChild.expand(!1,!1,function(){c.isRootSelected&&(h.getSelectionModel().select(j.firstChild),h.fireEvent("click",j.firstChild))})}),h}function processDailydirectoryTreeOption(a,b){function c(a){a.expand(!1,!1,function(){a.firstChild.leaf?d.isRootSelected&&i.fireEvent("click",a):c(a.firstChild)})}var d={shouldJugeMultizones:!1,rootId:!1,allOrg:!1,excludeRoot:!1,url:"/daily/dailyDirectoryManage/firstLoadDailydirectory.action",isLocalData:!1,isRootSelected:!0,isLoadDailyLogs:!1,afterNodeExpanded:!1};$.extend(d,a);var e=PATH+d.url;0!=d.rootId&&(e=-1==e.indexOf("?")?e+"?rootId="+d.rootId:e+"&rootId="+d.rootId),d.excludeRoot&&(e=-1==e.indexOf("?")?e+"?excludeRoot="+d.excludeRoot:e+"&excludeRoot="+d.excludeRoot),d.allOrg&&(e=-1==e.indexOf("?")?e+"?allOrg="+d.allOrg:e+"&allOrg="+d.allOrg),d.shouldJugeMultizones&&(e+=-1==e.indexOf("?")?"?shouldJugeMultizones=true":"&shouldJugeMultizones=true");var f=b.attr("id"),g=Ext.tree,h={animate:!0,enableDD:!1,containerScroll:!0,dropConfig:{appendOnly:!0},rootVisible:!1};d.isLocalData||(h.loader=new g.TreeLoader({dataUrl:e+"?dailyYearId="+a.dailyYearId+"&initTree="+b.attr("id")}));var i=new g.TreePanel(f,h);i.on("beforeload",function(c){if(c.id!=f+"-root"){var e="?dailyYearId="+a.dailyYearId+"&parentId="+c.id;d.isLoadDailyLogs&&2==c.attributes.leaf?i.loader.dataUrl=PATH+"/workingRecord/workingRecordManage/findExtTreeDataByDirectoryId.action"+e+"&initTree="+b.attr("id"):i.loader.dataUrl=PATH+d.url+e+"&initTree="+b.attr("id")}}),d.afterNodeExpanded&&i.on("load",d.afterNodeExpanded);var j=new g.TreeNode({text:"orgManage",draggable:!1,id:f+"dailyDirectory-root",dailyYearId:a.dailyYearId}),k=new g.AsyncTreeNode({text:"台账目录树",draggable:!1,id:f+"-root",leaf:!1,dailyYearId:a.dailyYearId});return j.appendChild(k),i.setRootNode(j),i.render(),d.isLocalData||c(k),i}function clearTreeSelected_org_autocomplete(a){$("#"+a).val(""),$("#org_autocomplete"+a).val("")}function rendSupervise(a,b,c){return 1==c.supervisionState||1==a?"<img src='/resource/system/images/normalcard.gif'>":100==c.supervisionState?"<img src='/resource/system/images/yellowcard.gif'>":200==c.supervisionState?"<img src='/resource/system/images/redcard.gif'>":""}function rendUrgent(a,b,c){return 1==c.urgent||1==a?"<img src='/resource/system/images/immediate.gif'>":""}function updateIssue(){var a=$("#issueList").getGridParam("selrow");if(null!=a){var b=$("#issueList").getRowData(a);$("#issueDialog").createDialog({width:840,height:570,title:"修改事件处理信息",url:"/issue/issueManage/dispatch.action?issueMode=edit&issueNew.id="+b.issueId+"&issueLogId="+b.issueLogId+"&organization.id="+$("#currentOrgId").val(),buttons:{"保存":function(a){$("#issueMaintainForm").submit()},"关闭":function(){$(this).dialog("close")}}})}}function editIssue(a){$("#issueDialog").createDialog({width:840,height:570,title:"修改事件处理信息",url:"/issues/issueManage/dispatch.action?mode=editIssueForTab&keyId="+a,buttons:{"保存":function(a){$("#issueMaintainForm").submit()},"关闭":function(){$(this).dialog("close")}}})}function deleteIssue(){var a=$("#issueList").getGridParam("selrow"),b=$("#issueList").getRowData(a);null!=a&&$.ajax({url:"/issue/issueManage/deleteIssueById.action",data:{"issueNew.id":b.issueId},success:function(a){a>0?($.messageBox({message:"已经成功删除该事件处理信息!"}),getMessageByUser()):$.messageBox({level:"error",message:"找不到要删除的事件处理信息，不能删除!"})}})}function removeIssue(a){$.ajax({url:"/issues/issueManage/deleteIssue.action",data:{keyId:a,viewType:$("#jurisdictionsViewType").val()},success:function(a){1==a?($.messageBox({message:"已经成功删除该事件处理信息!"}),setTimeout(reloadIssue,1e3),getMessageByUser()):$.messageBox({level:"error",message:"删除事件失败!"})}})}function removeIssueByIssueId(a){$.ajax({url:"/issues/issueManage/deleteIssue.action",data:{keyId:a},success:function(a){1==a?($.messageBox({message:"已经成功删除该事件!"}),setTimeout(reloadIssue,1e3),getMessageByUser()):$.messageBox({level:"error",message:"删除事件失败!"})}})}function settingIssueHistorical(a,b,c){isNullObject(a)||$.ajax({url:"/issues/issueManage/dealIssue.action",data:{keyId:a,dealCode:b,"struts.token":c},success:function(a){a.issueStepId>0?($.messageBox({message:"成功设置该事件的历史遗留状态!"}),setTimeout(reloadIssue,1e3),getMessageByUser()):$.messageBox({level:"error",message:a})}})}function historicalIssue(){var a=$("#issueList").getGridParam("selrow");null!=a&&$.ajax({url:"/issue/issueManage/historicalIssue.action",data:{"step.id":a},success:function(a){a>0?($.messageBox({message:"该事件处理已设置为历史遗留!"}),$(".message").click()):$.messageBox({message:a})}})}function issueRightHeight(){function a(){var a=$(".ui-layout-center").height()-$("#thisCrumbs").height()-$("#nav").height()-$(".ui-tabs .ui-tabs-nav li").height(),b=a-15,c=a-$(".issueLeft .issueTitle").height()-65;$(".issueProgram").height(b),$(".issueLeft").height(b),$(".issueLeft .issueList").height(c),$(".issueRight").height(b)}a(),$(window).resize(function(){clearTimeout(window._issueRightTimer),window._issueRightTimer=setTimeout(function(){a()},300)})}function mouseOverOrOut(){$(".issueLeft div").delegate(".issueList li","mouseover",function(){$(this).addClass("hoverCur").siblings().removeClass("hoverCur")}),$(".issueLeft div").delegate(".issueList li","mouseout",function(){$(this).removeClass("hoverCur")})}function initIssueList(){$(".issueList li a.handleLink").each(function(){110==$(this).html()?$(this).html("待受理").addClass("backlog"):140==$(this).html()?$(this).html("待阅读").addClass("state-read"):500==$(this).html()?$(this).html("已办"):1e3==$(this).html()?$(this).html("已完成"):$(this).html("办理中").addClass("state-proceed")})}function getData(){var a={id:$(".issueList li.current").attr("id"),issueStepId:$(".issueList li.current").attr("issueStepId"),supervisionState:$(".issueList li.current").attr("supervisionState"),issueLogId:$(".issueList li.current").attr("issueLogId")};return a}function setSuperviseButtons(){}function resetSuperviseButtonsState(){var a=$("#issueList").getGridParam("selrow"),b=!isNullObject(a);resetCancelSuperviseButtonState(b),resetRedSuperviseButtonState(b),resetYellowSuperviseButtonState(b),resetNormalSuperviseButtonState(b)}function resetRedSuperviseButtonState(a){a&&!redSupervised()?$("#redCardIssue").buttonEnable():$("#redCardIssue").buttonDisable()}function resetYellowSuperviseButtonState(a){!a||redSupervised()||yellowSupervised()?$("#yellowCardIssue").buttonDisable():$("#yellowCardIssue").buttonEnable()}function resetNormalSuperviseButtonState(a){!a||redSupervised()||yellowSupervised()||normalSupervised()?$("#normalIssue").buttonDisable():$("#normalIssue").buttonEnable()}function resetCancelSuperviseButtonState(a){a&&(normalSupervised()||yellowSupervised()||redSupervised())?$("#cancleSupervise").buttonEnable():$("#cancleSupervise").buttonDisable()}function redSupervised(){var a=getData();return!isNullObject(a)&&(200==a.supervisionState||void 0!=a.supervisionState&&-1!=a.supervisionState.indexOf("redcard.gif"))}function yellowSupervised(){var a=getData();return!isNullObject(a)&&(100==a.supervisionState||void 0!=a.supervisionState&&-1!=a.supervisionState.indexOf("yellowcard.gif"))}function normalSupervised(){var a=getData();return!isNullObject(a)&&(1==a.supervisionState||void 0!=a.supervisionState&&-1!=a.supervisionState.indexOf("normalcard.gif"))}function superviseIssue(a,b){isNullObject(a)||$("#issueDialog").createDialog({width:550,height:370,title:"督办",url:"/issues/issueManage/dispatchDeal.action?dealCode="+b+"&keyId="+a,buttons:{"确定":function(a){$("#superviseIssueForm").submit()},"关闭":function(){$(this).dialog("close")}}})}function cancelSupervise(a,b,c,d){isNullObject(a)||$.ajax({url:"/issues/issueManage/dealIssue.action",data:{dealCode:b,keyId:a,"struts.token":c,SUPERVISE_TOKEN_ID:d},success:function(b){b.issueStepId>0?($("#issueList").setRowData(a,b),$.messageBox({message:"成功取消对该部门的督办!"}),setTimeout(reloadIssue,1e3)):$.messageBox({message:b})}})}function normalIssue(){var a=getData();isNullObject(a)||isNullObject(a.issueLogId)||$("#issueDialog").createDialog({width:550,height:350,title:"普通督办",url:"/issue/issueBusinessManage/dispatchDeal.action?dealType=81&stepId="+a.issueLogId,buttons:{"确定":function(a){$("#superviseIssueForm").submit()},"关闭":function(){$(this).dialog("close")}}})}function yellowCardIssue(){var a=getData();isNullObject(a)||isNullObject(a.issueLogId)||$("#issueDialog").createDialog({width:550,height:350,title:"黄牌督办",url:"/issue/issueBusinessManage/dispatchDeal.action?dealType=83&stepId="+a.issueLogId,buttons:{"确定":function(a){$("#superviseIssueForm").submit()},"关闭":function(){$(this).dialog("close")}}})}function redCardIssue(){var a=getData();isNullObject(a)||isNullObject(a.issueLogId)||$("#issueDialog").createDialog({width:550,height:350,title:"红牌督办",url:"/issue/issueBusinessManage/dispatchDeal.action?dealType=86&stepId="+a.issueLogId,buttons:{"确定":function(a){$("#superviseIssueForm").submit()},"关闭":function(){$(this).dialog("close")}}})}function cancleSuperviseIssue(){var a=getData();if(!isNullObject(a)&&!isNullObject(a.issueLogId)){a.issueLogId;$.ajax({url:"/issue/issueBusinessManage/cancelSupervise.action?stepId="+a.issueLogId,data:{"issueLogNew.issue.id":a.issueId,"issueLogNew.id":a.issueLogId},success:function(a){a.issueLogId>0?($.messageBox({message:"对此处理过程的督办取消成功!"}),resetSuperviseButtonsState()):$.messageBox({message:a})}})}}function setUrgentButtons(a,b,c){"1"==$(".issueList li.current").attr("urgent")?($("#urgent").html("<span>取消加急</span>"),$("#urgent").attr("id","cancelUrgent"),$("#cancelUrgent").unbind("click").bind("click",function(){bindCancleUrgent(b,c)})):($("#cancelUrgent").html("<span>加急</span>"),$("#cancelUrgent").attr("id","urgent"),$("#urgent").unbind("click").bind("click",function(){bindUrgent(a)}))}function bindUrgent(a){var b=$(".issueList li.current").attr("issueStepId");hasRowSelected()?bindUrgentById(a,b):$.messageBox({level:"warn",message:"没有可加急的事件！"})}function bindUrgentById(a,b){isNullObject(b)?$.messageBox({level:"warn",message:"没有可加急的事件！"}):$("#issueDialog").createDialog({width:600,height:400,title:"加急",url:"/issues/issueManage/dispatchDeal.action?dealCode="+a+"&keyId="+b,buttons:{"确定":function(a){$("#singleContentDealForm").submit(),$("#urgent").find("span").html("取消加急");$("#urgent").attr("id","urgent")},"关闭":function(){$(this).dialog("close")}}})}function bindCancleUrgent(a,b){if(hasRowSelected()){var c=$(".issueList li.current").attr("issueStepId");bindCancleUrgentById(c,a,b)}else $.messageBox({level:"warn",message:"没有可取消加急的事件！"})}function bindCancleUrgentById(a,b,c){isNullObject(a)||$.confirm({title:"系统提示",message:"是否确定要取消对该事件处理的加急!",width:400,okFunc:function(){$.ajax({url:"/issues/issueManage/dealIssue.action",data:{keyId:a,dealCode:b,"struts.token":c},success:function(a){if(null!=a&&a.issueStepId){$.messageBox({message:"已经成功取消该事件处理的加急!"}),$("#urgent").find("span").html("加急");$("#cancelUrgent").attr("id","urgent")}else $.messageBox({message:a,level:"error"});reloadIssue()}})}})}function setUrgentButton(){resetUrgentButtonState()}function resetUrgentButton(a,b,c,d,e){if(a){if(isNullObject(b))return;isUrgented($("#issueList"))?bindCancelIssueUrgentEvent(b,d,e):bindUrgentIssueEvent(b,c)}else $.messageBox({level:"warn",message:"请选择一条事件后再操作！"})}function bindUrgentIssueEvent(a,b){var c=$("#urgent");null!=c&&"undefined"!=typeof c&&(c.html('<span><strong class="ui-ico-jiaji"></strong>加急</span>'),c.unbind("click"),c.click(function(c){$("#issueDialog").createDialog({width:600,height:400,title:"加急",url:"/issues/issueManage/dispatchDeal.action?dealCode="+b+"&keyId="+a,buttons:{"确定":function(a){$("#singleContentDealForm").submit()},"关闭":function(){$(this).dialog("close")}}})}))}function bindCancelIssueUrgentEvent(a,b,c){var d=$("#urgent");isNullObject(d)||(d.html('<span><strong class="ui-ico-qxjj"></strong>取消加急</span>'),d.unbind("click"),d.click(function(d){isNullObject(a)||$.confirm({title:"系统提示",message:"是否确定要取消对该事件处理的加急!",width:400,okFunc:function(){$.ajax({url:"/issues/issueManage/dealIssue.action",data:{keyId:a,dealCode:b,"struts.token":c},success:function(a){null!=a&&a.issueStepId?$.messageBox({message:"已经成功取消该事件处理的加急!"}):$.messageBox({message:a,level:"error"}),reloadIssue()}})}})}))}function resetUrgentButtonState(){var a=$(".issueList li.current").attr("issueStepId");isNullObject(a)?$("#urgent").buttonDisable():($("#urgent").buttonEnable(),isUrgented($("#issueList"))?bindCancelUrgentEvent():bindUrgentEvent())}function isUrgented(a){var b={urgent:$(".issueList li.current").attr("urgent")};return 1==b.urgent||void 0!=b.urgent&&-1!=b.urgent.indexOf("immediate.gif")}function bindCancelUrgentEvent(){var a=$("#urgent");isNullObject(a)||(a.html('<span><strong class="ui-ico-qxjj"></strong>取消加急</span>'),a.unbind("click"),a.click(function(a){var b=$(".issueList li.current").attr("issueStepId");isNullObject(b)||$.confirm({title:"系统提示",message:"是否确定要取消对该事件处理的加急!",width:400,okFunc:cancelUrgent})}))}function bindUrgentEvent(){var a=$("#urgent");null!=a&&"undefined"!=typeof a&&(a.html('<span><strong class="ui-ico-jiaji"></strong>加急</span>'),a.unbind("click"),a.click(function(a){urgentIssue()}))}function cancelUrgent(){var a=$(".issueList li.current").attr("issueStepId");isNullObject(a)||"true"==$("#urgent").attr("disabled")||$.ajax({url:"/issue/issueManage/cancelUrgentIssue.action",data:{"step.id":a},success:function(a){a.issueLogId?($.messageBox({message:"已经成功取消该事件处理的加急!"}),resetUrgentButtonState()):($.messageBox({message:a,level:"error"}),resetUrgentButtonState()),reloadIssue()}})}function urgentIssue(){var a=$(".issueList li.current").attr("issueStepId");isNullObject(a)||"true"==$("#urgent").attr("disabled")||$("#issueDialog").createDialog({width:690,height:430,title:"加急",url:"/issue/issueManage/dispatch.action?mode=urgent&step.id="+a,buttons:{"确定":function(a){$("#urgentIssueForm").submit()},"关闭":function(){$(this).dialog("close")}}})}function jqGridMultiSelectState(a,b){b?$("#cb_"+a).attr("checked","true"):$("#cb_"+a).removeAttr("checked")}function getActualjqGridMultiSelectCount(a){var b=getActualjqGridMultiSelectIds(a);return null==b||"undefined"==typeof b?0:b.length}function getActualjqGridMultiSelectIds(a){return $("#"+a).jqGrid("getGridParam","selarrrow")}function _existedInArray(a,b){if(null==a||"undefined"==typeof a)return!1;for(var c=0;c<a.length;c++){var d=a[c];if(d==b)return!0}return!1}function excelDownload(a,b,c,d){var e=navigator.userAgent;if(e.indexOf("MSIE 6.0")>-1)$("#"+c).createDialog({width:250,height:200,title:d,url:"${path}/common/exportExcel.jsp",postData:{gridName:b,downloadUrl:a},buttons:{"导出":function(a){$("#exceldownload").submit(),$(this).dialog("close")},"关闭":function(){$(this).dialog("close")}},shouldEmptyHtml:!1});else{""!=b&&(a=a+"?"+$.param($("#"+b).getPostData()));var f="<iframe style='display: none;' src='"+a+"'></iframe>";$("body").append(f)}}function isUpdate(a){$("#update").buttonDisable(),$("#delete").buttonDisable();var b=a.jqGrid("getGridParam","selrow"),c=a.jqGrid("getRowData",b),d=!1;$.ajax({async:!1,url:"/sentiments/sentimentsManage/isUpdate.action",data:{"issueNew.id":c.issueId},success:function(a){d=a}}),d&&($("#update").buttonEnable(),$("#delete").buttonEnable())}function isUpdate1(a){$("#update").buttonDisable(),$("#delete").buttonDisable();var b=a.jqGrid("getGridParam","selrow"),c=a.jqGrid("getRowData",b),d=!1;$.ajax({async:!1,url:"/sentiments/sentimentsManage/isUpdate1.action",data:{"issueNew.id":c.issueId},success:function(a){d=a}}),d&&($("#update").buttonEnable(),$("#delete").buttonEnable())}function processMyProfileTreeOption(a,b){var c={shouldJugeMultizones:!1,rootId:!0,allOrg:!1,excludeRoot:!1,url:"/resourcePool/directorySettingManage/firstLoadDirectory.action",isLocalData:!1,isRootSelected:!0,isLoadDailyLogs:!1,afterNodeExpanded:!1};$.extend(c,a);var d=PATH+c.url;c.orgType&&(d=-1==d.indexOf("?")?d+"?orgType="+c.orgType:d+"&orgType="+c.orgType),0!=c.rootId&&(d=-1==d.indexOf("?")?d+"?rootId="+c.rootId:d+"&rootId="+c.rootId),c.excludeRoot&&(d=-1==d.indexOf("?")?d+"?excludeRoot="+c.excludeRoot:d+"&excludeRoot="+c.excludeRoot),c.allOrg&&(d=-1==d.indexOf("?")?d+"?allOrg="+c.allOrg:d+"&allOrg="+c.allOrg),c.shouldJugeMultizones&&(d+=-1==d.indexOf("?")?"?shouldJugeMultizones=true":"&shouldJugeMultizones=true");var e=b.attr("id"),f=Ext.tree,g={animate:!0,enableDD:!1,containerScroll:!0,dropConfig:{appendOnly:!0},rootVisible:!0};c.isLocalData||(g.loader=new f.TreeLoader({dataUrl:d}));var h=new f.TreePanel(e,g);h.on("beforeload",function(a){if(a.id!=e+"-root"&&a.id!=e+"myProfileDirectory-root"){var b="?parentId="+a.id;c.orgType&&(b=b+"&orgType="+c.orgType),h.loader.dataUrl=PATH+"/resourcePool/directorySettingManage/firstLoadDirectory.action"+b}}),c.afterNodeExpanded&&h.on("load",c.afterNodeExpanded);var i=new f.AsyncTreeNode({text:"资料目录",draggable:!1,id:e+"-root",leaf:!1});return h.setRootNode(i),h.render(),c.isLocalData||i.expand(!1,!1,function(a){i.firstChild.expand(!1,!1,function(){c.isRootSelected&&(h.getSelectionModel().select(i),h.fireEvent("click",i))})}),h}jQuery.fn.extend({initResourcePoolPremissionTree:function(a){return Ext.override(Ext.tree.TreeNodeUI,{onDblClick:function(a){if(a.preventDefault(),!this.node.disabled&&(!this.checkbox||this.node.hasChildNodes())){if(!this.animating&&this.node.hasChildNodes()){var b=this.node.ownerTree.doubleClickExpand;if(b)return;this.node.toggle()}this.fireEvent("dblclick",this.node,a)}}}),proccessResourcePoolPremissionTreeOption(a,$(this))},disableNode:function(a,b){a.getNodeById(b).disable()}}),jQuery.fn.extend({initResourcedirectoryTree:function(a){return processResourcePoolTreeOption(a,$(this))}}),jQuery.fn.extend({initPermissionTree:function(a){return processPermissionTreeOption(a,$(this))}}),jQuery.fn.extend({initDailydirectoryTree:function(a){return processDailydirectoryTreeOption(a,$(this))}}),$.fn.extend({treeSelect:function(a){function b(){$("#"+e+"-div").parent().parent().remove(),d.width(d.width()-25),$("#"+e+"-div").bgiframe()}function c(a){return void 0==a?"":a}var d=$(this),e=d.attr("id"),f={store:new Ext.data.SimpleStore({fields:[],data:[[]]}),editable:!1,showClearButton:!1,mode:"local",triggerAction:"all",name:"org",fieldLabel:"组织机构",maxHeight:300,maxWidth:250,listWidth:250,tpl:"<div id='"+e+"-div'><div id='"+e+"-tree' style='overflow:auto'></div></div>",selectedClass:"",onSelect:Ext.emptyFn,emptyText:"请选择...",inputName:"",allOrg:!1,url:!1,nodeUrl:!1,rootId:!1,inputCodeName:"",isRootSelected:!0,isFuncDep:!1,directlySupervisor:!1,changeFun:function(a,b){}};$.extend(f,a),b();var g=new Ext.form.ComboBox(f);g.applyTo(e);var h;h=f.url?f.url:"/sysadmin/orgManage/firstLoadExtTreeData.action";var i;i=f.nodeUrl?f.nodeUrl:"/sysadmin/orgManage/ajaxOrgsForExtTree.action";var j=null;j="initTree"===f.treeFunc?$("#"+e+"-tree").initTree({shouldJugeMultizones:!0,allOrg:f.allOrg,url:h,nodeUrl:i,directlySupervisor:f.directlySupervisor,rootId:f.rootId,loadCom:f.loadCom,isFuncDep:f.isFuncDep,isRootSelected:f.isRootSelected}):$("#"+e+"-tree").initAdministrativeTree({shouldJugeMultizones:!0,allOrg:f.allOrg,url:h,nodeUrl:i,directlySupervisor:f.directlySupervisor,rootId:f.rootId,loadCom:f.loadCom,isFuncDep:f.isFuncDep,isRootSelected:f.isRootSelected}),$("#"+e+"-div").height(f.maxHeight).width(f.listWidth);(function(){var a="org_autocomplete"+e;f.showClearButton?$("#"+e+"-div").parent().parent().prepend("<div class='ui-widget currentOrgTxt' style='width:100%;background:#fff;'><input id="+a+" type='text' value='请输入层级' style='height:24px;line-height:24px;border:1px solid #ccc;padding-left:5px;margin:5px 10px;width:160px;' /><a href='javascript:clearTreeSelected_org_autocomplete(\""+e+"\")'>清空</a></div>"):$("#"+e+"-div").parent().parent().prepend("<div class='ui-widget currentOrgTxt' style='width:100%;background:#fff;'><input id="+a+" type='text' value='请输入层级' style='height:24px;line-height:24px;border:1px solid #ccc;padding-left:5px;margin:5px 10px;width:160px;' /></div>")})();return $("#org_autocomplete"+e).autocomplete({source:function(a,b){$.ajax({url:PATH+"/sysadmin/orgManage/ajaxFindOrganizationsByOrgName.action",data:{"organization.orgName":a.term},success:function(a){b($.map(a,function(a){return{label:a.orgName+","+c(a.contactWay),value:a.orgName,id:a.id}}))},error:function(){$.messageBox({message:"搜索失败，请重新登入！",level:"error"})}})},select:function(b,c){var d="/sysadmin/orgManage/ajaxSearchParentNodeIds.action?organization.id="+c.item.id;void 0!=a.rootId&&(d=d+"&rootId="+a.rootId),$("#user_autocomplete").removeAttr("userId"),$("#user_autocomplete").val(""),$.ajax({url:PATH+d,success:function(a){$.searchChild(j,a)}})}}),$("#org_autocomplete"+e).bind("focusin",function(){this.value===this.defaultValue&&(this.value="")}).bind("focusout",function(){""===this.value&&(this.value=this.defaultValue)}),j.on("click",function(a,b){null!=a&&(g.setRawValue(a.text),g.collapse(),$("input[name='"+f.inputName+"']").val()!=a.id&&$("input[name='"+f.inputName+"']").val(a.id),$("input[name='"+f.inputCodeName+"']").val()!=a.attributes.orgInternalCode&&$("input[name='"+f.inputCodeName+"']").val(a.attributes.orgInternalCode)),f.changeFun(a,b)}),$("#"+e+"-tree").height(f.maxHeight-20),j}}),function(a){a.fn.extend({columnChart:function(b,c){Highcharts.theme={colors:["#514F78","#42A07B","#9B5E4A","#72727F","#1F949A","#82914E","#86777F","#DF5353","#7798BF","#aaeeee","#ff0066","#eeaaee"]},Highcharts.setOptions(Highcharts.theme);var d=a(this),e=(d.height(),""),f={url:"",quantity:"",moduleName:"",renderTo:d.attr("id"),defaultSeriesType:"column",width:null,ajax:!0,textx:"",events:{load:function(){a.sigmaReportLayout()}},margin:40,marginTop:60,marginBottom:60,options3d:{enabled:!0,alpha:0,beta:0,depth:120,viewDistance:250}};if(void 0!=f.renderTo){a.extend(f,b);var g={chart:f,title:{align:"center",text:"",margin:30},style:{fontFamily:"Arial"},xAxis:{categories:[]},yAxis:{allowDecimals:!1,opposite:!1,min:0,title:{text:""},labels:{align:"right",x:1}},legend:{align:"left",x:70,verticalAlign:"top",y:30,floating:!0,backgroundColor:"#FFFFFF",borderColor:"#CCC",borderWidth:1,shadow:!1},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+this.series.name+": "+this.y+("false"==b.isShowSum?"":"<br/>"+f.moduleName+"总数量: "+this.point.stackTotal)}},plotOptions:{column:{stacking:"normal",depth:25}},series:[],credits:{enabled:!0,text:"",href:"javascript:;",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#000000",fontSize:"10px"}},lang:{downloadPNG:"下载成 PNG 格式",downloadJPEG:"下载成 JPEG 格式",downloadPDF:"下载成 PDF 格式",downloadSVG:"",exportButtonTitle:"导出图片",printButtonTitle:"打印"},exporting:{buttons:{printButton:{enabled:!1,onclick:function(){a(this.container).printArea()}},exportButton:{enabled:!1,align:"right",x:-30,y:45}}}};if(f.ajax)a.ajax({async:!1,url:f.url,success:function(b){var d="";if(null==b||null==b.series)return!1;d=""!=f.moduleName?f.moduleName:b.moduleName;var h=90;if(null!=b&&null!=b.categories&&b.categories.length>13){var i=b.categories.length;g.chart.width=h*i}var j,k,l=0,m="";if(b.series.length<=2)for(j=0;j<b.series.length;j++)for(k=0;k<b.categories.length;k++)""==m&&(m=b.series[j].stack),m==b.series[j].stack&&(l+=b.series[j].data[k]);else if(4==b.series.length&&1==b.categories.length)for(j=0;j<b.series.length;j++)for(k=0;k<b.categories.length;k++)""==m&&(m=b.series[j].stack),m==b.series[j].stack&&(l+=b.series[j].data[k]);else for(j=0;j<b.series.length;j++)for(k=0;k<b.categories.length;k++)""==m&&(m=b.series[j].stack),m==b.series[j].stack&&(l+=b.series[j].data[k]);if(g.title.text=d+"(总计: "+l+"个)",g.yAxis.title.text=d+"y轴（"+f.quantity+"）（1k=1000）",g.title.x=f.textx,""!=f.legend&&a.extend(g.legend,f.legend),g.xAxis.categories=b.categories,g.series=b.series,a.extend(!0,g,c),1==g.workbenchColum&&b.categories.length>5){var n={labels:{rotation:-45,style:{fontSize:"11px"}}};a.extend(!0,g.xAxis,n)}try{e=new Highcharts.Chart(g)}catch(o){throw a.messageBox({message:o,level:"error"}),new Error(o)}}});else{var h={title:{text:"",margin:15},plotOptions:{column:{stacking:null}},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+this.series.name+": "+this.y}},exporting:{buttons:{exportButton:{enabled:!1,align:"right"},printButton:{enabled:!1}}},legend:{align:"left",x:70,verticalAlign:"top",y:-10,floating:!0,backgroundColor:"#FFFFFF",borderColor:"#CCC",borderWidth:1,shadow:!1}};a.extend(g,h),e=Highcharts.visualize(f.table,g)}return a("#"+f.renderTo).children(".highcharts-container").css({overflow:"auto",width:"100%","overflow-y":"auto"}),d.data("chart",e),e}}}),a.fn.extend({columnChartOfTaskList:function(b,c){Highcharts.theme={colors:["#514F78","#42A07B","#9B5E4A","#72727F","#1F949A","#82914E","#86777F","#DF5353","#7798BF","#aaeeee","#ff0066","#eeaaee"]},Highcharts.setOptions(Highcharts.theme);var d=a(this),e=(d.height(),""),f={url:"",quantity:"",moduleName:"",renderTo:d.attr("id"),defaultSeriesType:"column",width:null,ajax:!0,textx:"",events:{load:function(){a.sigmaReportLayout()}},margin:40,marginTop:60,marginBottom:60,options3d:{enabled:!0,alpha:0,beta:0,depth:120,viewDistance:250}};if(void 0!=f.renderTo){a.extend(f,b);var g={chart:f,title:{align:"center",text:"",margin:30},style:{fontFamily:"Arial"},xAxis:{categories:[]},yAxis:{allowDecimals:!1,opposite:!1,min:0,title:{text:""},labels:{align:"right",x:1}},legend:{align:"left",x:70,verticalAlign:"top",y:30,floating:!0,backgroundColor:"#FFFFFF",borderColor:"#CCC",borderWidth:1,shadow:!1},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+this.series.name+": "+this.y+("false"==b.isShowSum?"":"<br/>")}},plotOptions:{column:{pointPadding:.2,borderWidth:0}},series:[],credits:{enabled:!0,text:"",href:"javascript:;",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#000000",fontSize:"10px"}},lang:{downloadPNG:"下载成 PNG 格式",downloadJPEG:"下载成 JPEG 格式",downloadPDF:"下载成 PDF 格式",downloadSVG:"",exportButtonTitle:"导出图片",printButtonTitle:"打印"},exporting:{buttons:{printButton:{enabled:!1,onclick:function(){a(this.container).printArea()}},exportButton:{enabled:!1,align:"right",x:-30,y:45}}}};if(f.ajax)a.ajax({async:!1,url:f.url,success:function(b){var d="";if(null==b||null==b.series)return!1;d=""!=f.moduleName?f.moduleName:b.moduleName;var h=90;if(null!=b&&null!=b.categories&&b.categories.length>13){var i=b.categories.length;g.chart.width=h*i}var j,k,l=0,m="";if(b.series.length<=2)for(j=0;j<b.series.length;j++)for(k=0;k<b.categories.length;k++)""==m&&(m=b.series[j].stack),m==b.series[j].stack&&(l+=b.series[j].data[k]);else if(4==b.series.length&&1==b.categories.length)for(j=0;j<b.series.length;j++)for(k=0;k<b.categories.length;k++)""==m&&(m=b.series[j].stack),m==b.series[j].stack&&(l+=b.series[j].data[k]);else for(j=0;j<b.series.length;j++)for(k=0;k<b.categories.length;k++)""==m&&(m=b.series[j].stack),m==b.series[j].stack&&(l+=b.series[j].data[k]);if(g.title.text=d,g.yAxis.title.text=d+"y轴（"+f.quantity+"）（1k=1000）",g.title.x=f.textx,""!=f.legend&&a.extend(g.legend,f.legend),g.xAxis.categories=b.categories,g.series=b.series,a.extend(!0,g,c),1==g.workbenchColum&&b.categories.length>5){var n={labels:{rotation:-45,style:{fontSize:"11px"}}};a.extend(!0,g.xAxis,n)}try{e=new Highcharts.Chart(g)}catch(o){throw a.messageBox({message:o,level:"error"}),new Error(o)}}});else{var h={title:{text:"",margin:15},plotOptions:{column:{stacking:null}},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+this.series.name+": "+this.y}},exporting:{buttons:{exportButton:{enabled:!1,align:"right"},printButton:{enabled:!1}}},legend:{align:"left",x:70,verticalAlign:"top",y:-10,floating:!0,backgroundColor:"#FFFFFF",borderColor:"#CCC",borderWidth:1,shadow:!1}};a.extend(g,h),e=Highcharts.visualize(f.table,g)}return a("#"+f.renderTo).children(".highcharts-container").css({overflow:"auto",
width:"100%","overflow-y":"auto"}),d.data("chart",e),e}}}),a.fn.extend({pieChart:function(b,c){Highcharts.theme={colors:["#514F78","#42A07B","#9B5E4A","#72727F","#1F949A","#82914E","#86777F","#DF5353","#7798BF","#aaeeee","#ff0066","#eeaaee"]},Highcharts.setOptions(Highcharts.theme);var d={url:"",moduleName:"",renderTo:a(this).attr("id"),plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,msgInfo:"",onClick:function(a){},margin:50,options3d:{enabled:!0,alpha:45,beta:0}};a.extend(d,b);var e=a(this),f="",g=(b.msgInfo,{chart:d,title:{text:d.moduleName+"类型分布图",margin:30},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+(.001==this.y?"0":this.y)+" %"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",formatter:function(){return this.y&&""==this.y.toString()?"<b>"+this.point.name+"</b>":"<b>"+this.point.name+"</b>: "+(.001==this.y?"0":this.y)+" %"}},events:{click:d.onClick}}},series:[{type:"pie",name:"Browser share",data:[]}],credits:{enabled:!0,text:"",href:"javascript:;",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#000000",fontSize:"10px"}},lang:{downloadPNG:"下载成 PNG 格式",downloadJPEG:"下载成 JPEG 格式",downloadPDF:"下载成 PDF 格式",downloadSVG:"",exportButtonTitle:"",printButtonTitle:"打印"},exporting:{buttons:{exportButton:{enabled:!1},printButton:{enabled:!1,onclick:function(){a(this.container).printArea()}}}}});return a.ajax({async:!1,url:d.url,success:function(b){if(null==b||""==b||-1!=b.indexOf("errorCode"))return a.messageBox({message:"查询的月份没有数据生成",level:"error"}),!1;for(var d=b.length-1;d>=0;d--)b[d][1]||(b[d][1]=.001);g.series[0].data=b,a.extend(!0,g,c),f=new Highcharts.Chart(g)}}),e.data("chart",f),f}}),a.fn.extend({lineChart:function(b,c){var d={url:"",moduleName:"",ajax:!0,options3d:{enabled:!0},isReverse:!0,renderTo:a(this).attr("id"),defaultSeriesType:"spline",isIssue:!1},e=a(this);a.extend(d,b);var f=0;d.isIssue&&(f=null);var g="",h={chart:d,title:{text:""},xAxis:{categories:[]},yAxis:{allowDecimals:!1,min:f,title:{text:""}},tooltip:{crosshairs:!0,shared:!0},plotOptions:{spline:{marker:{radius:4,lineColor:"#666666",lineWidth:1}}},series:{},credits:{enabled:!0,text:"",href:"javascript:;",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#000000",fontSize:"10px"}},legend:{align:"left",x:70,verticalAlign:"top",y:18,floating:!0,backgroundColor:"#FFFFFF",borderColor:"#CCC",borderWidth:1,shadow:!1},lang:{downloadPNG:"下载成 PNG 格式",downloadJPEG:"下载成 JPEG 格式",downloadPDF:"下载成 PDF 格式",downloadSVG:"",exportButtonTitle:"",printButtonTitle:"打印"},exporting:{exportButton:{align:"right",x:-30,y:45},buttons:{exportButton:{enabled:!1},printButton:{enabled:!1,onclick:function(){a(this.container).printArea()}}}}};if(d.ajax)a.get(d.url,function(b){var e="";e=""!=d.moduleName?d.moduleName:b.moduleName,h.title.text=e,h.yAxis.title.text=e,h.xAxis.categories=b.categories,h.series=b.series,a.extend(!0,h,c),g=new Highcharts.Chart(h)});else{var i={isReverse:d.isReverse,legend:{align:"left",x:70,verticalAlign:"top",y:-10,floating:!0,backgroundColor:"#FFFFFF",borderColor:"#CCC",borderWidth:1,shadow:!1}};a.extend(h,i),g=Highcharts.visualize(d.table,h)}return e.data("chart",g),g}}),Highcharts.visualize=function(b,c){var d=-1,e=a(b).attr("id").substring(5,a(b).attr("id").length);c.xAxis.categories=[];var f=jQuery("#"+e+" tr.ui-row-ltr:visible").get();c.isReverse&&f.reverse(),a(f).each(function(b){var e=a(this).find("td:visible").first().text();""!=e&&("合计"==e?d=b:(c.xAxis.categories.push(e),d=-1))}),c.series=[],jQuery("#"+a(b).attr("id")+" .ui-jqgrid-htable .ui-th-ltr:visible").each(function(b){var d=a(this).find(".ui-jqgrid-sortable:visible").first().text();c.series[b-1]={name:d,data:[]}}),a(f).each(function(a){var b=this;d!=a&&jQuery("td:visible",b).each(function(a){a>0&&c.series[a-1].data.push(parseFloat(this.innerHTML))})});var g=120;if(c.xAxis.categories.length>13){var h=c.xAxis.categories.length;c.chart.width=g*h}var i=new Highcharts.Chart(c);return i}}(jQuery),function(a){function b(){if(j.mode==h.iframe||!j.strict)return"";var a=0==j.strict?" Trasitional":"",b=0==j.strict?"loose":"strict";return'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01'+a+'//EN" "http://www.w3.org/TR/html4/'+b+'.dtd">'}function c(b){return'<body><div class="'+a(b).attr("class")+'">'+a(b).html()+"</div></body>"}function d(b){return a("input,select,textarea",b).each(function(){var b=a(this).attr("type");if("radio"==b||"checkbox"==b)a(this).is(":not(:checked)")?this.removeAttribute("checked"):this.setAttribute("checked",!0);else if("text"==b)this.setAttribute("value",a(this).val());else if("select-multiple"==b||"select-one"==b)a(this).find("option").each(function(){a(this).is(":not(:selected)")?this.removeAttribute("selected"):this.setAttribute("selected",!0)});else if("textarea"==b){var c=a(this).attr("value");a.browser.mozilla?this.firstChild?this.firstChild.textContent=c:this.textContent=c:this.innerHTML=c}}),b}function e(){var b,c=j.id,d="border:0;position:absolute;width:0px;height:0px;left:0px;top:0px;";try{b=document.createElement("iframe"),document.body.appendChild(b),a(b).attr({style:d,id:c,src:""}),b.doc=null,b.doc=b.contentDocument?b.contentDocument:b.contentWindow?b.contentWindow.document:b.document}catch(e){throw e+". iframes may not be supported in this browser."}if(null==b.doc)throw"Cannot find document.";return b}function f(){var a="location=yes,statusbar=no,directories=no,menubar=no,titlebar=no,toolbar=no,dependent=no";a+=",width="+j.popWd+",height="+j.popHt,a+=",resizable=yes,screenX="+j.popX+",screenY="+j.popY+",personalbar=no,scrollbars=no";var b=window.open("","_blank",a);return b.doc=b.document,b}var g=0,h={iframe:"iframe",popup:"popup"},i={mode:h.iframe,popHt:500,popWd:400,popX:200,popY:200,popTitle:"",popClose:!1},j={};a.fn.printArea=function(k){a.extend(j,i,k),g++;var l="printArea_";a("[id^="+l+"]").remove();var m=d(a(this));j.id=l+g;var n,o;switch(j.mode){case h.iframe:var p=new e;n=p.doc,o=p.contentWindow||p;break;case h.popup:o=new f,n=o.doc}n.open(),n.write(b()+"<html>"+c(m)+"</html>"),n.close(),o.focus(),o.print(),j.mode==h.popup&&j.popClose&&o.close()}}(jQuery),$.fn.issueFlow=function(a){var b=$(this),c=b.attr("id"),d={data:[],stepHeight:200,stepWidth:200};$.extend(d,a);var e=1,f=24,g=function(){var a,b,c;return a=parseInt(128+128*Math.sin(1.3*(3*e+0))),b=parseInt(128+128*Math.sin(1.3*(3*e+1))),c=parseInt(128+128*Math.sin(1.3*(3*e+2))),e+=1,e>f&&(e=1),"rgb("+a+","+b+","+c+")"};return this.PopData=[],this.popup=function(a){var b=this,c={top:0,left:0,url:""};$.extend(c,a);(function(){var a,d=!0;$("#holderBoxPop")[0]?a=$("#holderBoxPop"):(a=$('<div class="raphaelTips" id="holderBoxPop"><a href="javascript:;" class="tip-close">关闭</a><div class="raphaelTips-text"></div><div class="raphaelTips-angle diamond"></div></div>'),a.find(".tip-close").click(function(){$("#holderBoxPop").fadeOut(300)}),a.appendTo("body"));var e,f=$("#holderBoxPop").find(".raphaelTips-text").empty(),g={lines:10,length:10,width:5,radius:5,corners:1,rotate:0,direction:1,color:"#999",speed:1,trail:100,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"};$("#holderBoxPop").show().animate({top:$(c.thatDom[0]).offset().top-c.thatDom.height()-110,left:$(c.thatDom[0]).offset().left+c.thatDom.width()/2-130},50),$("#holderBoxPop").click(function(a){a.stopPropagation()});for(var h=0;h<b.PopData.length;h++)b.PopData[h].id==c.thatDom.data("id")&&(e=b.PopData[h],d=!1);if(""!=c.url&&1==d){new Spinner(g).spin(f[0]);$.ajax({url:c.url,success:function(a){f.html(a),e={id:c.thatDom.data("id"),data:""},e.data=a,b.PopData.push(e)}})}else f.html(e.data);$(document).one("click",function(){$("#holderBoxPop").hide()}),$(".issueRight").scroll(function(){$("#holderBoxPop").hide()})})()},this.build=function(a){for(var e=d.stepHeight+10,f=d.stepWidth,g="",h=new Array,i=0,j=0;j<a.length;j++){var k=!0;i<a[j].orgLevelInternalId&&(i=a[j].orgLevelInternalId);for(var l=0;l<h.length;l++)a[j].orgId==h[l].orgId&&(k=!1);if(1==k){for(var m=0,l=0;l<h.length;l++)a[j].orgLevelInternalId==h[l].orgLevelInternalId&&m++;a[j].index=m,h.push(a[j])}}for(var j=0;j<h.length;j++){var n=(i/10-h[j].orgLevelInternalId/10)*e,o=(f+250)*h[j].index,p='<div class="step" style="top:'+n+"px;left:"+o+'px;" id="'+c+"step"+h[j].orgId+'" data-id="'+h[j].id+'" data-orgid='+h[j].orgId+'><span class="name">'+h[j].name+"</span></div>";g+=p}b.append(g)},this.connect=function(a){this.connects=[];for(var b=0;b<a.length;b++){var d=a[b].to;if($(a).each(function(){this.id==d&&(d=this.orgId)}),d){var e={source:c+"step"+a[b].orgId,target:c+"step"+d,ConnectionsDetachable:!1,joinstyle:"round",connector:["StateMachine",{curviness:1}],connectorStyle:{lineWidth:4,strokeStyle:"#deea18",joinstyle:"round",outlineColor:"#EAEDEF",outlineWidth:2},paintStyle:{lineWidth:3,strokeStyle:"#c6591e",dashstyle:"4 2",joinstyle:"miter"},detachable:!1,anchor:"",endpointsOnTop:!0,overlays:[["Label",{label:'<div class="relation" id="label_'+a[b].id+'" data-id="'+a[b].id+'" data-orgid="'+a[b].orgId+'"><div class="number">'+(b+1)+'</div><div class="text">'+a[b].relation+"</div></div>"}],["Arrow",{location:1,id:"arrow",length:14,foldback:.8}]]},f=jsPlumb.connect(e);$(f.canvas).attr("data-id",a[b].id).attr("data-orgid",a[b].orgId),this.connects.push(f)}}},this.init=function(a){var b=this;b.build(a),jsPlumb.reset(),jsPlumb.importDefaults({Endpoint:["Dot",{radius:.1}],Connector:"StateMachine",HoverPaintStyle:{strokeStyle:"#42a62c",lineWidth:2},ConnectionOverlays:[["Arrow",{location:1,id:"arrow",length:14,foldback:.8}]]}),jsPlumb.draggable($("#"+c+" .step"),{create:function(){$(this).data("defaultLeft",$(this).css("left")).data("defaultTop",$(this).css("top"))},stop:function(){jsPlumb.animate($(this).attr("id"),{left:$(this).data("defaultLeft"),top:$(this).data("defaultTop")},{duration:1400,easing:"easeOutBack"})}}),$("#"+c).delegate(".relation","click",function(a){var c=$(this),d=c.data("id"),e=c.data("orgid");b.popup({thatDom:c,url:"/issues/issueManage/viewIssueDealLog.action?issueMap.id="+d+"&issueMap.orgId="+e}),a.stopPropagation()}),jsPlumb.makeTarget($("#"+c+" .step"),{dropOptions:{hoverClass:"dragHover"},anchor:"Continuous"}),$("#"+c+" .step").each(function(a,b){jsPlumb.makeSource($(b),{anchor:"Continuous",connectorStyle:{strokeStyle:g(),lineWidth:2}})}),b.connect(a)},this.init(d.data),this},$.fn.extend({mailUtil:function(option){function mailMainInit(a){$.ajax({type:"GET",url:a.url,dataType:a.datatype,data:{page:a.page,rows:a.rowNum,sidx:a.sidx,sord:a.sord},success:function(b){a.mailData=b,initMailRow(a),clickMailRow(a),selectAllFun(a),rowSelect(selectValue),initPager(a),clickSelectPage(a)}})}function mailMain(a){$.ajax({type:"GET",url:a.url,dataType:a.datatype,data:{page:a.page,rows:a.rowNum,sidx:a.sidx,sord:a.sord},success:function(b){a.mailData=b,self.addClass("mailBox"),initMailThead(a),initMailRow(a),clickMailRow(a),selectAllFun(a),rowSelect(selectValue),initPager(a),clickSelectPage(a)}})}function initMailThead(defaultOption){for(var colTheadId="colThead",rowContentId="rowContent",colNumber=defaultOption.colModel.length,colModelName=eval(defaultOption.colModel),colWidthNum=0,colContent="",colWidth=0,colThead=$('<div id="'+colTheadId+'"><strong class="checkboxItem"><input type="checkbox" class="form-checkbox" id="selectAll" /><input type="checkbox" class="form-checkbox" id="canelSelectAll" style="display:none;" /></strong></div><div class="clear"></div>'),i=0;colNumber>i;i++)colModelName[i].hidden||(colThead.append('<span class="rowItem" sidx="'+colModelName[i].name+'" id="'+selfId+colModelName[i].name+'" style="width:'+colModelName[i].width+"px;text-align:"+colModelName[i].align+';">'+colModelName[i].label+"</span>"),colModelName[i].width&&(colWidthNum++,colWidth+=Number(colModelName[i].width)));self.append(colThead),sortMail(defaultOption);for(var i=0;colNumber>i;i++)colModelName[i].hidden||colModelName[i].width||$("#"+selfId+colModelName[i].name).width((self.width()-colWidth-50)/($("#"+colTheadId).find(".rowItem").length-colWidthNum))}function initMailRow(defaultOption){for(var colTheadId="colThead",rowContentId="rowContent",colNumber=defaultOption.colModel.length,colModelName=eval(defaultOption.colModel),colWidthNum=0,colContent="",colWidth=0,i=0;colNumber>i;i++)colModelName[i].hidden||colModelName[i].width&&(colWidthNum++,colWidth+=Number(colModelName[i].width));for(var rowNumber=defaultOption.mailData.rows.length,rowData=defaultOption.mailData.rows,rowContent=$("<div />").attr("id",rowContentId).width(defaultOption.width).height(defaultOption.height-30).css("overflow","auto"),i=0;rowNumber>i;i++){for(var rowCon=$('<div class="rowCon" id="'+rowData[i].id+'" loading="false"><strong class="checkboxItem"><input class="form-checkbox" type="checkbox" rowid="'+rowData[i].id+'" /></strong></div>'),j=0;colNumber>j;j++)colModelName[j].hidden||rowCon.append('<span class="rowItem" id=rowItem'+rowData[i].id+"-"+j+' title="'+rowData[i][colModelName[j].name]+'" style="width:'+colModelName[j].width+'px;">'+rowData[i][colModelName[j].name]+"</span>"),colModelName[j].formatter&&(rowData[i][colModelName[j].name]=colModelName[j].formatter);rowContent.append(rowCon)}self.append(rowContent);for(var i=0;rowNumber>i;i++)for(var j=0;colNumber>j;j++)colModelName[j].hidden||(colModelName[j].width||$("#rowItem"+rowData[i].id+"-"+j).width((self.width()-colWidth-60)/($("#"+colTheadId).find(".rowItem").length-colWidthNum)),colModelName[j].align&&$("#rowItem"+rowData[i].id+"-"+j).css("text-align",colModelName[j].align));clickRowScrollTop()}function sortMail(a){$("#colThead .rowItem").toggle(function(){var b=$(this).attr("sidx");$(a.pager).empty(),$("#rowContent").remove(),a.sidx=b,a.sord="desc",mailMainInit(a)},function(){var b=$(this).attr("sidx");$(a.pager).empty(),$("#rowContent").remove(),a.sidx=b,a.sord="asc",mailMainInit(a)})}function initPager(a){var b=a.mailData.records/a.rowNum;if(0>=b)return $(a.pager).append(""),void $(".pagePrev").bind("click",function(){reload(a)});b=Math.floor(b)==b?Math.floor(b):Math.floor(b)+1;for(var c='<input type="button" class="firstPage defaultButton" value="第一页" />',d='<input type="button" class="lastPage defaultButton" value="最后一页" />',e='<input type="button" class="prevPage defaultButton" value="上一页" />',f='<input type="button" class="nextPage defaultButton" value="下一页" />',g='<select id="rowSelect">',h=0;h<a.rowList.length;h++)g=g+'<option value="'+a.rowList[h]+'">'+a.rowList[h]+"</option>";g+="</select>";var i='<div class="pageInfo">共'+a.mailData.records+"条数据&nbsp;&nbsp;当前第"+a.page+"/"+b+"页</div>";$(a.pager).append(c+e+f+d+i+g),$("#rowSelect").val(a.rowNum),$(".firstPage").bind("click",function(){1!=a.page&&(toPager(a,1),a.page=1)}),$(".lastPage").bind("click",function(){a.page!=b&&(toPager(a,b),a.page=b)}),$(".prevPage").bind("click",function(){a.page>1&&(a.page=a.page-1,toPager(a,a.page))}),$(".nextPage").bind("click",function(){a.page!=b&&(a.page=a.page+1,toPager(a,a.page))})}function rowSelect(a){$(".rowCon .form-checkbox").bind("click",function(){a="",self.find(".rowCon .form-checkbox").each(function(){(1==$(this).attr("checked")||"checked"==$(this).attr("checked"))&&(a=a+$(this).parent().parent().attr("id")+",")}),defaultOption.rowSelect(a)})}function clickMailRow(a){self.find(".rowCon span").bind("click",function(){var b=$(this).parent(),c=b.attr("id");"true"==b.attr("selected")?(b.addClass("selectRow"),$("#mailBoxContent"+c).hide(),b.removeClass("borderTop").attr("selected","false")):($(".mailBoxContent").hide(),$(".rowCon").removeClass("borderTop").removeClass("selectRow").attr("selected","false"),b.addClass("borderTop"),"false"==b.attr("loading")?(b.after("<div class='mailBoxContent' id=mailBoxContent"+c+"></div>").addClass("borderTop"),$("#mailBoxContent"+c).attr("selecked","true").show(),$("#mailBoxContent"+c).load(a.mailBoxUrl+c,function(){b.attr("loading","true")})):$("#mailBoxContent"+c).show(),b.attr("selected","true"))})}function clickRowScrollTop(){self.find(".rowCon").bind("click",function(){var a=$(this).attr("id"),b=0;$("#rowContent").find(".rowCon").each(function(c,d){return $(this).attr("id")==a?!1:void(b+=$(this).height())}),$("#rowContent").scrollTop(b)})}function clickSelectPage(a){$("#rowSelect").bind("change",function(){a.rowNum=$(this).attr("value"),$("#rowContent").remove(),$(a.pager).empty(),mailMainInit(a)})}function selectAllFun(a){$("#selectAll").click(function(){self.find(".rowCon .form-checkbox").attr("checked",!0),$("#canelSelectAll").attr("checked",!0),$(this).attr("checked",!0),$(this).hide(),$("#canelSelectAll").show(),selectValue="",self.find(".rowCon .form-checkbox").each(function(){selectValue=selectValue+$(this).parent().parent().attr("id")+","}),a.allSelect(selectValue)}),$("#canelSelectAll").click(function(){self.find(".rowCon .form-checkbox").attr("checked",!1),$("#selectAll").attr("checked",!1),$(this).attr("checked",!1),$(this).hide(),$("#selectAll").show(),selectValue=""})}function toPager(a,b){$(a.pager).empty(),$("#rowContent").remove(),a.page=b,mailMainInit(a)}var self=$(this),selfId=self.attr("id"),defaultOption={url:"",mailBoxUrl:"",subGridPostData:{},colModel:[],mailData:[],rowNum:15,datatype:"json",rowList:[10,15,20,30],viewrecords:!0,multiselect:!1,subGrid:!0,jsonReader:{repeatitems:!1,id:"0"},height:"auto",width:"auto",sidx:"id",sord:"asc",pager:"#"+$(this).attr("id")+"Pager",page:1,showColModelButton:!1,subGridRowExpanded:function(a,b){},subGridRowColapsed:function(a,b){},ondblClickRow:function(a){self.toggleSubGridRow(a)},caption:!1,gridComplete:function(){},rowSelect:function(a){alert(a)},allSelect:function(a){alert(a)}},selectValue="";$.extend(defaultOption,option),mailMain(defaultOption),self.height(defaultOption.height)}}),jQuery.fn.extend({initMyProfileTree:function(a){return processMyProfileTreeOption(a,$(this))}}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;if(void 0!==e[b])return b;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function h(a){return"undefined"==typeof this?new h(a):void(this.opts=f(a||{},h.defaults,n))}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:j+" "+j,coordorigin:-i+" "+-i}),{width:j,height:j})}function g(a,g,h){b(l,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~g}),b(e(c("roundrect",{arcsize:d.corners}),{width:i,height:d.width,left:d.radius,top:-d.width>>1,filter:h}),c("fill",{color:d.color,opacity:d.opacity}),c("stroke",{opacity:0}))))}var h,i=d.length+d.width,j=2*i,k=2*-(d.width+d.length)+"px",l=e(f(),{position:"absolute",top:k,left:k});if(d.shadow)for(h=1;h<=d.lines;h++)g(h,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(h=1;h<=d.lines;h++)g(h);return b(a,l)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c,d,f=this,h=f.opts,i=f.el=e(a(0,{className:h.className}),{position:h.position,width:0,zIndex:h.zIndex}),k=h.radius+h.length+h.width;if(b&&(b.insertBefore(i,b.firstChild||null),d=g(b),c=g(i),e(i,{left:("auto"==h.left?d.x-c.x+(b.offsetWidth>>1):parseInt(h.left,10)+k)+"px",top:("auto"==h.top?d.y-c.y+(b.offsetHeight>>1):parseInt(h.top,10)+k)+"px"})),i.setAttribute("role","progressbar"),f.lines(i,f.opts),!j){var l,m=0,n=(h.lines-1)*(1-h.direction)/2,o=h.fps,p=o/h.speed,q=(1-h.opacity)/(p*h.trail/100),r=p/h.lines;!function s(){m++;for(var a=0;a<h.lines;a++)l=Math.max(1-(m+(h.lines-a)*r)%p*q,h.opacity),f.opacity(i,a*h.direction+n,l,h);f.timeout=f.el&&setTimeout(s,~~(1e3/o))}()}return f},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function g(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*i+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var h,i=0,k=(f.lines-1)*(1-f.direction)/2;i<f.lines;i++)h=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,k+i*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(h,e(g("#000","0 0 4px #000"),{top:"2px"})),b(d,b(h,g(f.color,"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h});